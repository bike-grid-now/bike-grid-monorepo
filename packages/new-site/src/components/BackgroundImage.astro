---
import { Picture } from "@astrojs/image/components";

export interface Props {
  src: string;
  alt: string;
  maxWidth: number;
  brightness?: string | number;
}
const { src, alt, maxWidth, brightness = "1.0" } = Astro.props;
---

<div>
  <div class="image">
    <Picture
      {src}
      {alt}
      widths={[maxWidth * 0.25, maxWidth * 0.5, maxWidth * 1]}
      formats={["webp", "avif", "png"]}
      sizes="100vw"
      aspectRatio={undefined}
      background={undefined}
    />
  </div>
  <slot />
</div>

<style define:vars={{ brightness, backgroundImage: src }}>
  div {
    /* Required for the filter on the background. */
    position: relative;
    width: 100%;
    display: block;
  }

  .image {
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
    width: 100%;
    height: 100%;
    filter: brightness(var(--brightness));
    overflow: hidden;
  }
</style>
