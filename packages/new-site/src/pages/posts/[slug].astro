---
import Layout from "../../layouts/Layout.astro";

import { postFromSlug } from "../../lib/sanity";
import Container from "../../components/Container.astro";
import Rounded from "../../components/Rounded.astro";
import CalendarDate from "../../components/CalendarDate.astro";
import Stack from "../../components/Stack.astro";
import { PortableText } from "astro-portabletext";

const { slug } = Astro.params;

const post = await postFromSlug(slug!);
---

<Layout title={post?.title ?? ""}>
  <Container class="mt-4">
    <Rounded>
      <div class="py-10 px-6 md:p-16 text-white">
        {post && <h1 class="text-5xl font-bold mb-6">{post.title}</h1>}
        {
          post?.subtitle && (
            <h2 class="text-2xl font-medium mb-4">{post.subtitle}</h2>
          )
        }
        <Stack
          justify="between"
          direction="row"
          class="text-zinc-400 fill-current"
        >
          {post?.date && <CalendarDate date={post.date.local} />}
        </Stack>
        {
          post?.image && (
            <img
              src={post.image.imageUrl}
              alt={post.image.altText}
              class="w-full rounded-2xl my-12"
              style="width: 100%; border-radius: 15px"
            />
          )
        }
        {
          post?.body && (
            <div class="prose prose-invert lg:prose-xl mx-auto">
              <PortableText value={post.body} />
            </div>
          )
        }
      </div>
    </Rounded>
  </Container>
</Layout>
